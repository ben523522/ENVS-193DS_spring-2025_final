---
title: "final"
format: docx
editor: visual
---

## Problem 1

### a. 

In part 1, they used a correlation test to assess the relationship between distance from the headwater (km) and annual total nitrogen load (kg/year). Since both are continuous variables and a p-value is reported, they probably used a Pearson correlation test. However, if the data weren’t normally distributed, a Spearman correlation could have been used instead.

In part 2, they likely used an analysis of variance (ANOVA) to test whether average nitrogen load differs between multiple source types: urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands. ANOVA is a standard method for comparing averages across more than two groups.

## 

### b. 

Post-hoc comparisons between source groups: The ANOVA test shows that there is a difference in average nitrogen load among the five sources, but it doesn’t say which specific sources are different from each other. A post-hoc test like Tukey’s HSD would help compare each pair of sources (for example, urban land vs. fertilizer) to see where the real differences lie.

Group averages and variation: The report should include the average nitrogen load for each source, along with a measure of spread like standard deviation or confidence intervals. This would make it easier to understand how much nitrogen each source contributes and how consistent those values are across observations.

### c.

In part 1:\
There is a significant relationship between distance from the headwater and annual total nitrogen load, suggesting that nitrogen levels change as you move downstream. (Correlation test, r = \[correlation coefficient\], p = 0.03, test statistic = \[test statistic\], sample size = \[n\])

In part 2:\
Average nitrogen load differs among sources such as urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands. Further comparisons are needed to identify which sources differ. (ANOVA, F = \[F value\], p = 0.02, degrees of freedom = \[df\], sample size = \[n\])

## Problem 2

### a. 

```{r}

# Load required libraries
library(tidyverse)
library(lubridate)
library(dplyr)

# Read the data
sst_data <- read_csv("data/SST_update2023.csv")

# Clean and process the data
sst_clean <- sst_data %>%
  # Convert date to Date type and extract year and month
  mutate(date = ymd(date),
         year = year(date),
         month = month(date)) %>%
  # Group by year and month
  group_by(year, month) %>%
  # Calculate mean temperature for each month
  summarise(mean_mnthly_sst = round(mean(temp, na.rm = TRUE), 1)) %>%
  # Arrange chronologically
  arrange(year, month) %>%
  # Convert to data frame
  as.data.frame()

# View the result
slice_sample(sst_clean, n = 5)
str(sst_clean)

```

### b. 

```{r}


#| fig-height: 5
#| fig-width: 10
#| fig-align: center
#| warning: false

library(ggplot2)
library(dplyr)
library(lubridate)

# Prepare the data
sst_recent <- sst_clean %>% 
  filter(year >= 2018 & year <= 2023) %>%
  mutate(month_abb = month.abb[month],
         month_abb = factor(month_abb, levels = month.abb),
         year = factor(year))  # Convert year to factor for proper coloring

# Create gradient color palette (light to dark green)
year_palette <- colorRampPalette(c("#e5f5e0", "#006d2c"))(length(unique(sst_recent$year)))

ggplot(sst_recent, aes(x = month_abb, y = mean_mnthly_sst, 
                       group = year, color = year)) +
  # Geometries
  geom_line(linewidth = 1.2, alpha = 0.8) +
  geom_point(size = 3, alpha = 0.8) +
  
  # Color scale (light to dark green gradient)
  scale_color_manual(values = year_palette, name = "Year") +
  
  # Labels and text
  labs(title = "Monthly Average Sea Surface Temperature (2018-2023)",
       x = "Month of Observation",
       y = "Temperature (°C)",
       caption = "Data source: NOAA SST Monitoring Network") +
  
  # Theme adjustments
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold", margin = margin(b = 15)),
    axis.title.x = element_text(size = 12, margin = margin(t = 10)),
    axis.title.y = element_text(size = 12, margin = margin(r = 10)),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
    axis.text.y = element_text(size = 10),
    legend.title = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 10),
    legend.position = c(0.1, 0.8),  # Inside panel position
    legend.background = element_rect(fill = "white", color = "gray50"),
    panel.background = element_rect(fill = "white", color = "black"),  # Panel border
    panel.grid.major = element_line(color = "gray90"),
    panel.grid.minor = element_blank(),
    plot.caption = element_text(size = 9, color = "gray50", hjust = 1)
  )
```

## Problem 3

### a.

the 1 is placed in the column representing occupation by a specific bird species or emptiness.

### b. 
